<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        body {
            background: #ccc;
        }

        #map {
            width: 600px;
            margin: 50px auto;
        }

        .grid {
            float: left;
            width: 50px;
            height: 50px;
            background-color: #fff;
            margin: 2px;
            transition: .3s;
        }

        .end {
            background: #000;
        }

        .disabled {
            background: red;
        }

        .active {
            background: lightblue;
        }
    </style>
</head>
<body>

<div id="map">

</div>

<script>
    let oMap = document.getElementById('map');

    const maps = [
        0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0,
        0, 0, 0, 0, 0, 1, 2, 1, 0, 0, 0,
        0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ]
    maps.forEach((n, index) => {
        var grid = document.createElement('span');
        if (n === 1) {
            grid.className = 'grid disabled';
        } else if (n === 2) {
            grid.className = 'grid end';
        } else {
            grid.className = 'grid';
        }
        grid.index = index;
        oMap.appendChild(grid);
        grid.onclick = function () {
            document.querySelectorAll('.grid').forEach(grid => {
                grid.classList.remove('active');
            });
            let path = autoPath(index, maps.indexOf(2));
            if( path.length < 1 ) {
                return;
            }
            let grids = document.getElementsByClassName('grid');
            let times = 0;
            let timmer = null;
            timmer = setInterval(() => {
                grids[path[times]].classList.add('active');
                times++;
                if( times === path.length ) {
                    clearInterval(timmer);
                }
            }, 30);
        }
    })

    function getArea(n) {
        if (n % 11 === 0) {
            if (n < 11) {
                return [n + 1, n + 11].filter(num => num >= 0 && maps[num] !== 1);
            } else if (n > 109) {
                return [n - 11, n + 1].filter(num => num >= 0 && maps[num] !== 1);
            }
            return [n - 11, n + 1, n + 11].filter(num => num >= 0 && maps[num] !== 1);
        } else if (n % 11 === 10) {
            if (n < 11) {
                return [n - 1, n + 11].filter(num => num >= 0 && maps[num] !== 1);
            } else if (n > 109) {
                return [n - 11, n - 1].filter(num => num >= 0 && maps[num] !== 1);
            }
            return [n - 1, n - 11, n + 11].filter(num => num >= 0 && maps[num] !== 1);
        }
        return [n - 1, n - 11, n + 1, n + 11].filter(num => num >= 0 && maps[num] !== 1);
    }

    //  自动寻路
    function autoPath(start, end = 14) {
        let openList = [];
        let closeList = [];
        let s = start;
        let g = 0;
        let map = []

        openList.push(s);

        map.push({value: start})

        function loop() {
            if (openList.length < 1) {
                console.log('搜索结束，无法到达');
                return;
            } else {
                //  未检测待检测坐标
                g = openList.shift();
                closeList.push(g);
                let area = getArea(g);

                for (let i = 0; i < area.length; i++) {
                    if (!openList.includes(area[i]) && !closeList.includes(area[i])) {
                        openList.push(area[i]);
                        map.push({value: area[i], parent: g});
                    }
                    if (g === end) {
                        return;
                    }
                }
                loop();
            }
        }

        loop();
        let path = [];
        let target = end;

        function getPath() {
            for (let i = 0; i < map.length; i++) {
                if (map[i].value === target) {
                    if (map[i].value !== end) {
                        path.unshift(map[i].value);
                    }
                    target = map[i].parent;
                    getPath();
                }
            }
        }

        getPath();
        return path;
    }


</script>
</body>
</html>